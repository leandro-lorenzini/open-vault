[![CodeQL](https://github.com/leandro-lorenzini/open-vault/actions/workflows/github-code-scanning/codeql/badge.svg?branch=main)](https://github.com/leandro-lorenzini/open-vault/actions/workflows/github-code-scanning/codeql)
# open-vault
Open-vault is password manager designed for small and medium organizations with support to SAML authentication, it allows teams to share passwords for those applications that do not support identity management, it relies on public/private keys for securely storing and sharing passwords.

## Features
:white_check_mark: Safely stores password and TOTPs in a central database

:white_check_mark: Sharing passwords and TOTPs with colleagues

:white_check_mark: Password and TOTP encryption/decryption executed by the client (Plain text password/TOTP never transmitted to the server)

:white_check_mark: Local Database authentication or Single Sign-on using SAML standard

:white_check_mark: Security dashboard with checks for weak and old passwords

:white_check_mark: Organization master key for password/TOTP recovery

## Installation process
### Preparing the client
#### Option 1 - Download build from repository
You can download the build for macOs, Windows and Linux under the [releases page](../../releases) of this repository.
#### Option 2 - Build the client
The advantage of building it yourself is that you can set the default server address, so if you are deploying to multiple users, they won't have to manually set the server address.
1. Clone the repository to your local machine.
2. Building the client (Installer)
```bash
cd gui
export REACT_APP_SERVER_URL="https://<YOUR-SERVER-URL>/"
npm install
npm run build && npm run make
```
The building process only generates the installer for the current OS, so you might need to run these commands in different devices to get other version of the installar as well. Eg. Run the commands on MacOs to generate the pkg and the dmg files, run it on Windows to generate the exe and chocolatey files.

### Deploying the server
1. Clone the repository to the server where you want to deploy the application.
2. Copy the [client installer files](../../releases) to the sever's `assets` folder, those files can be found under the release page of this repository. If you built the client by yourself, then youse the instead.
3. Update the ```./server/docker-compose``` variables
```bash
DATABASE_URL="mongodb://<USER>:<PASSWD>@<MONGO-URL>:27017/open-vault?authSource=admin"
URL="https://<SERVER FQDN>/"
PORT=443
SESSION_SECRET="<RAMDOM STRINGT>"
INSTALLER_VERSION="0.1.3"
WINDOWS_INSTALLER=<0|1>
MAC_INSTALLER=<0|1>
LINUX_INSTALLER=<0|1>
```
5. Place the server SSL certificate as follows:
    - ./server/cert.pem
    - ./server/key.pem
Note that a valid certificate has to be provided, otherwise the client won't be able to communicate with the server when running the client in Production mode.
6. Start the server.
```bash
cd server
docker-compose up -d
```
6. Configure the server.
Install the client that has been generated on the first step on your local machine. Once the client starts it will then detect that this is a new server deployment and will ask you to setup the organization. Simply provide the information the if asked during the wizard and that's it.

## Development notes
### Technology & stack
- NodeJs
- React
- Electron
- Ant Design
- MongoDB

### Useful commands
Generate self-signed certificate to use in development mode
```bash
cd server
openssl genrsa -out key.pem
openssl req -new -key key.pem -out csr.pem
openssl x509 -req -days 365 -in csr.pem -signkey key.pem -out cert.pem
```

Starting the client in development mode
```bash
cd gui
npm react
npm start
```

## How it works
Passwords are all stored in the database after being encrypted using each user’s public key.

he encryption and decryption of passwords are always performed by the client, meaning that the server will never receive any plain text password.

The private key is generated by the client and only stored in the client’s device and is never sent to the server. 
The private key is also protected by a local password that is defined by the user after the first login.

When a user creates or updates a password, the password will be encrypted using every user’s public keys and the ciphertext will be sent to the server and stored in the database, a syncronization happens every 15 seconds in the client level to make sure evey one has the newest version of evey password.


### Project status and disclaimer
This is a new project, and I only work on it during my free time, so I'm more than happy to have collaborators. Feel free to challenge the concept, the code logic and to create pull requests with improvements.

